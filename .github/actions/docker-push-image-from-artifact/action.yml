name: Docker Publish Image From Artifact

inputs:
  artifact-name:
    required: true
    type: string
  registry-user:
    required: true
    type: string
  registry-password:
    required: true
    type: string

runs:
  using: composite
  steps:
    - name: Log in to the Container registry
      uses: docker/login-action@v2
      with:
        registry: ghcr.io
        username: ${{ inputs.registry-user }}
        password: ${{ inputs.registry-password }}

    - name: Get Artifact
      uses: actions/download-artifact@v2
        with:
          name: ${{ artifact-name }}
          path: /tmp/${{ artifact-name }}/

    - name: Load Image
      shell: bash
      run: docker load --input /tmp/${{ artifact-name }}/image.tar

    - name: Push Image
      shell: bash
      run: docker push ${{ inputs.target-image }}